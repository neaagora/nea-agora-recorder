# Nea Agora Service Recorder — v0.5.1 Status

## Summary

v0.5.1 fixes a record integrity issue discovered during v0.5 dogfooding.

When switching between ChatGPT conversations within the same browser tab, earlier versions could assign events from multiple chats to a single session. This release introduces **conversation-scoped session IDs** to prevent session mixing while preserving all existing event and metric structures.

---

## What Changed in v0.5.1

### Conversation-Scoped Session IDs

- Session IDs are now derived from the active ChatGPT conversation URL:
  - `chatgpt-c-<conversationId>` when a conversation is present
  - `chatgpt-tab-<id>` only when no conversation ID exists (e.g. landing page)
- Switching chats in the same tab results in **separate sessions**
- No manual session reset or UI interaction required

---

## What Did Not Change

- Event schemas remain unchanged
- Metric definitions remain unchanged:
  - `userMessageCount`
  - `llmMessageCount`
  - copy and timing metrics
- No inference or retroactive rewriting of past records

Existing records remain valid.

---

## Session Semantics (Explicit)

- v0.5.0:
  - Session scope = browser tab lifetime
- v0.5.1:
  - Session scope = ChatGPT conversation when identifiable
  - Tab-scoped fallback only when no conversation is active

This makes session boundaries explicit and observable.

---

## Known Limitations

- LLM message counting is DOM-based and may be off by one in some edge cases
  (e.g. regen or UI re-render).
- No attempt is made to infer semantic “task” boundaries.

These limitations are intentional and documented.

---

## Rationale

The goal of v0.5.1 is to improve **record integrity**, not to increase inference.

Conversation-scoped session IDs align better with how humans perceive ChatGPT interactions while avoiding fragile heuristics or hidden assumptions.

---

## Status

✅ Tested with multiple chats in the same tab  
✅ Produces clean, separated sessions  
✅ Ready for publication and demo use  
